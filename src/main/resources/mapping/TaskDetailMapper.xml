<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cit.dmt.core.dao.TaskDetailMapper">
  <resultMap id="BaseResultMap" type="com.cit.dmt.core.model.TaskDetail">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Feb 25 21:10:27 NZDT 2021.
    -->
    <id column="t_id" jdbcType="BIGINT" property="id" />
    <result column="t_project_id" jdbcType="BIGINT" property="projectId" />
    <result column="t_task_id" jdbcType="BIGINT" property="taskId" />
    <result column="t_original" jdbcType="VARCHAR" property="original" />
    <result column="t_country" jdbcType="VARCHAR" property="country" />
    <result column="t_language" jdbcType="VARCHAR" property="language" />
    <result column="t_gec" jdbcType="VARCHAR" property="gec" />
    <result column="t_memo" jdbcType="VARCHAR" property="memo" />
    <result column="t_roman_status" jdbcType="CHAR" property="romanStatus" />
    <result column="t_roman" jdbcType="VARCHAR" property="roman" />
    <result column="t_trans_status" jdbcType="CHAR" property="transStatus" />
    <result column="t_transliteration" jdbcType="VARCHAR" property="transliteration" />
    <result column="t_free_translation" jdbcType="VARCHAR" property="freeTranslation" />
    <result column="t_check_status" jdbcType="CHAR" property="checkStatus" />
    <result column="t_trans_result" jdbcType="VARCHAR" property="transResult" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Feb 25 21:10:27 NZDT 2021.
    -->
    t.id as t_id, t.project_id as t_project_id, t.task_id as t_task_id, t.original as t_original, 
    t.country as t_country, t.language as t_language, t.gec as t_gec, t.memo as t_memo, 
    t.roman_status as t_roman_status, t.roman as t_roman, t.trans_status as t_trans_status, 
    t.transliteration as t_transliteration, t.free_translation as t_free_translation, 
    t.check_status as t_check_status, t.trans_result as t_trans_result
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Feb 25 21:10:27 NZDT 2021.
    -->
    select 
    <include refid="Base_Column_List" />
    from task_detail t
    where t.id = #{id,jdbcType=BIGINT}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Feb 25 21:10:27 NZDT 2021.
    -->
    delete from task_detail
    where id = #{id,jdbcType=BIGINT}
  </delete>
  <insert id="insert" parameterType="com.cit.dmt.core.model.TaskDetail">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Feb 25 21:10:27 NZDT 2021.
    -->
    insert into task_detail (id, project_id, task_id, 
      original, country, language, 
      gec, memo, roman_status, 
      roman, trans_status, transliteration, 
      free_translation, check_status, trans_result
      )
    values (#{id,jdbcType=BIGINT}, #{projectId,jdbcType=BIGINT}, #{taskId,jdbcType=BIGINT}, 
      #{original,jdbcType=VARCHAR}, #{country,jdbcType=VARCHAR}, #{language,jdbcType=VARCHAR}, 
      #{gec,jdbcType=VARCHAR}, #{memo,jdbcType=VARCHAR}, #{romanStatus,jdbcType=CHAR}, 
      #{roman,jdbcType=VARCHAR}, #{transStatus,jdbcType=CHAR}, #{transliteration,jdbcType=VARCHAR}, 
      #{freeTranslation,jdbcType=VARCHAR}, #{checkStatus,jdbcType=CHAR}, #{transResult,jdbcType=VARCHAR}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.cit.dmt.core.model.TaskDetail">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Feb 25 21:10:27 NZDT 2021.
    -->
    insert into task_detail
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="id != null">
        id,
      </if>
      <if test="projectId != null">
        project_id,
      </if>
      <if test="taskId != null">
        task_id,
      </if>
      <if test="original != null">
        original,
      </if>
      <if test="country != null">
        country,
      </if>
      <if test="language != null">
        language,
      </if>
      <if test="gec != null">
        gec,
      </if>
      <if test="memo != null">
        memo,
      </if>
      <if test="romanStatus != null">
        roman_status,
      </if>
      <if test="roman != null">
        roman,
      </if>
      <if test="transStatus != null">
        trans_status,
      </if>
      <if test="transliteration != null">
        transliteration,
      </if>
      <if test="freeTranslation != null">
        free_translation,
      </if>
      <if test="checkStatus != null">
        check_status,
      </if>
      <if test="transResult != null">
        trans_result,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="id != null">
        #{id,jdbcType=BIGINT},
      </if>
      <if test="projectId != null">
        #{projectId,jdbcType=BIGINT},
      </if>
      <if test="taskId != null">
        #{taskId,jdbcType=BIGINT},
      </if>
      <if test="original != null">
        #{original,jdbcType=VARCHAR},
      </if>
      <if test="country != null">
        #{country,jdbcType=VARCHAR},
      </if>
      <if test="language != null">
        #{language,jdbcType=VARCHAR},
      </if>
      <if test="gec != null">
        #{gec,jdbcType=VARCHAR},
      </if>
      <if test="memo != null">
        #{memo,jdbcType=VARCHAR},
      </if>
      <if test="romanStatus != null">
        #{romanStatus,jdbcType=CHAR},
      </if>
      <if test="roman != null">
        #{roman,jdbcType=VARCHAR},
      </if>
      <if test="transStatus != null">
        #{transStatus,jdbcType=CHAR},
      </if>
      <if test="transliteration != null">
        #{transliteration,jdbcType=VARCHAR},
      </if>
      <if test="freeTranslation != null">
        #{freeTranslation,jdbcType=VARCHAR},
      </if>
      <if test="checkStatus != null">
        #{checkStatus,jdbcType=CHAR},
      </if>
      <if test="transResult != null">
        #{transResult,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.cit.dmt.core.model.TaskDetail">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Feb 25 21:10:27 NZDT 2021.
    -->
    update task_detail
    <set>
      <if test="projectId != null">
        project_id = #{projectId,jdbcType=BIGINT},
      </if>
      <if test="taskId != null">
        task_id = #{taskId,jdbcType=BIGINT},
      </if>
      <if test="original != null">
        original = #{original,jdbcType=VARCHAR},
      </if>
      <if test="country != null">
        country = #{country,jdbcType=VARCHAR},
      </if>
      <if test="language != null">
        language = #{language,jdbcType=VARCHAR},
      </if>
      <if test="gec != null">
        gec = #{gec,jdbcType=VARCHAR},
      </if>
      <if test="memo != null">
        memo = #{memo,jdbcType=VARCHAR},
      </if>
      <if test="romanStatus != null">
        roman_status = #{romanStatus,jdbcType=CHAR},
      </if>
      <if test="roman != null">
        roman = #{roman,jdbcType=VARCHAR},
      </if>
      <if test="transStatus != null">
        trans_status = #{transStatus,jdbcType=CHAR},
      </if>
      <if test="transliteration != null">
        transliteration = #{transliteration,jdbcType=VARCHAR},
      </if>
      <if test="freeTranslation != null">
        free_translation = #{freeTranslation,jdbcType=VARCHAR},
      </if>
      <if test="checkStatus != null">
        check_status = #{checkStatus,jdbcType=CHAR},
      </if>
      <if test="transResult != null">
        trans_result = #{transResult,jdbcType=VARCHAR},
      </if>
    </set>
    where id = #{id,jdbcType=BIGINT}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.cit.dmt.core.model.TaskDetail">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Feb 25 21:10:27 NZDT 2021.
    -->
    update task_detail
    set project_id = #{projectId,jdbcType=BIGINT},
      task_id = #{taskId,jdbcType=BIGINT},
      original = #{original,jdbcType=VARCHAR},
      country = #{country,jdbcType=VARCHAR},
      language = #{language,jdbcType=VARCHAR},
      gec = #{gec,jdbcType=VARCHAR},
      memo = #{memo,jdbcType=VARCHAR},
      roman_status = #{romanStatus,jdbcType=CHAR},
      roman = #{roman,jdbcType=VARCHAR},
      trans_status = #{transStatus,jdbcType=CHAR},
      transliteration = #{transliteration,jdbcType=VARCHAR},
      free_translation = #{freeTranslation,jdbcType=VARCHAR},
      check_status = #{checkStatus,jdbcType=CHAR},
      trans_result = #{transResult,jdbcType=VARCHAR}
    where id = #{id,jdbcType=BIGINT}
  </update>
  <select id="selectPaged" parameterType="java.util.HashMap" resultMap="BaseResultMap">
    select
    <include refid="Base_Column_List" />
    from task_detail t
    where 1=1
    <if test="projectId != null">
      and t.project_id = #{projectId,jdbcType=BIGINT}
    </if>
    <if test="taskId != null">
      and t.task_id = #{taskId,jdbcType=BIGINT}
    </if>
    <if test="transStatus != null">
      and t.trans_status = #{transStatus,jdbcType=CHAR}
    </if>
    <if test="checkStatus != null">
      and t.check_status = #{checkStatus,jdbcType=CHAR}
    </if>
    <if test="original != null">
      and t.original like #{original,jdbcType=VARCHAR}
    </if>
    <if test="orderByClause != null">
      order by ${orderByClause}
    </if>
  </select>
  <update id="finalTrans">
    update task_detail
    set check_status = '1',
      trans_result = #{transResult,jdbcType=VARCHAR}
    where id = #{id,jdbcType=BIGINT}
  </update>
  <update id="finalTransBatch">
    update task_detail
      join check_assignment_detail on
        task_detail.id = check_assignment_detail.task_detail_id
        and check_assignment_detail.check_status = '1'
        and check_assignment_detail.project_id = #{projectId,jdbcType=BIGINT}
        and check_assignment_detail.task_id = #{taskId,jdbcType=BIGINT}
        and check_assignment_detail.round_id = #{roundId,jdbcType=BIGINT}
      <if test="userId != null">
        and check_assignment_detail.user_id = #{userId,jdbcType=BIGINT}
      </if>
    set task_detail.check_status = '1',
      task_detail.trans_result = check_assignment_detail.check_result
  </update>
  <insert id="insertBatch">
    insert into task_detail (project_id, task_id, 
      original, country, language, 
      gec, memo, roman_status, 
      trans_status, check_status
      )
    values
    <foreach collection="taskDetails" item="item" separator=",">
    (#{item.projectId,jdbcType=BIGINT}, #{item.taskId,jdbcType=BIGINT}, 
      #{item.original,jdbcType=VARCHAR}, #{item.country,jdbcType=VARCHAR}, #{item.language,jdbcType=VARCHAR}, 
      #{item.gec,jdbcType=VARCHAR}, #{item.memo,jdbcType=VARCHAR}, #{romanStatus,jdbcType=CHAR}, 
      #{item.transStatus,jdbcType=CHAR}, #{item.checkStatus,jdbcType=CHAR})
    </foreach>
  </insert>
  <delete id="deleteBatch">
    delete from task_detail
    where project_id = #{projectId,jdbcType=BIGINT}
      and task_id = #{taskId,jdbcType=BIGINT}
  </delete>
  <select id="getTaskDetailAmount" resultType="java.lang.Integer">
    select
      count(t.id)
    from task_detail t
    where t.project_id = #{projectId,jdbcType=BIGINT}
      and t.task_id = #{taskId,jdbcType=BIGINT}
  </select>
</mapper>